<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>yawning_titan.networks.network &mdash; YAWNING TITAN 1.1.1
 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/docs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> YAWNING TITAN
          </a>
              <div class="version">
                1.1.1

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../source/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/create_a_network.html">Create a Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/db.html">Yawning-Titan DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/experiments.html">Monitoring Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/game_mode_config_explained.html">GameMode UML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/_autosummary/yawning_titan.html">Yawning-Titan API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/_autosummary/tests.html">Yawning-Titan Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/contributing.html">Contribute to YT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/license.html">MIT License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/dependencies.html">Dependencies</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">YAWNING TITAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">yawning_titan.networks.network</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for yawning_titan.networks.network</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">getLogger</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">networkx.drawing.layout</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">bipartite_layout</span><span class="p">,</span>
    <span class="n">circular_layout</span><span class="p">,</span>
    <span class="n">fruchterman_reingold_layout</span><span class="p">,</span>
    <span class="n">kamada_kawai_layout</span><span class="p">,</span>
    <span class="n">multipartite_layout</span><span class="p">,</span>
    <span class="n">planar_layout</span><span class="p">,</span>
    <span class="n">random_layout</span><span class="p">,</span>
    <span class="n">rescale_layout</span><span class="p">,</span>
    <span class="n">shell_layout</span><span class="p">,</span>
    <span class="n">spectral_layout</span><span class="p">,</span>
    <span class="n">spiral_layout</span><span class="p">,</span>
    <span class="n">spring_layout</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">choice</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="kn">from</span> <span class="nn">yawning_titan.db.doc_metadata</span> <span class="kn">import</span> <span class="n">DocMetadata</span>
<span class="kn">from</span> <span class="nn">yawning_titan.exceptions</span> <span class="kn">import</span> <span class="n">NetworkError</span>
<span class="kn">from</span> <span class="nn">yawning_titan.networks.node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="n">_LOGGER</span> <span class="o">=</span> <span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="NetworkLayout"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.NetworkLayout.html#yawning_titan.networks.network.NetworkLayout">[docs]</a><span class="k">class</span> <span class="nc">NetworkLayout</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An enum class that maps to layout functions in networkx.drawing.layout.</span>

<span class="sd">    See: https://networkx.org/documentation/stable/reference/drawing.html#module-networkx.drawing.layout</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">BIPARTITE</span> <span class="o">=</span> <span class="s2">&quot;bipartite&quot;</span>
    <span class="n">CIRCULAR</span> <span class="o">=</span> <span class="s2">&quot;circular&quot;</span>
    <span class="n">FRUCHTERMAN_REINGOLD</span> <span class="o">=</span> <span class="s2">&quot;fruchterman_reingold&quot;</span>
    <span class="n">KAMADA_KAWAI</span> <span class="o">=</span> <span class="s2">&quot;kamada_kawai&quot;</span>
    <span class="n">MULTIPARTITE</span> <span class="o">=</span> <span class="s2">&quot;multipartite&quot;</span>
    <span class="n">PLANAR</span> <span class="o">=</span> <span class="s2">&quot;planar&quot;</span>
    <span class="n">RANDOM</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span>
    <span class="n">RESCALE</span> <span class="o">=</span> <span class="s2">&quot;rescale&quot;</span>
    <span class="n">SHELL</span> <span class="o">=</span> <span class="s2">&quot;shell&quot;</span>
    <span class="n">SPECTRAL</span> <span class="o">=</span> <span class="s2">&quot;spectral&quot;</span>
    <span class="n">SPIRAL</span> <span class="o">=</span> <span class="s2">&quot;spiral&quot;</span>
    <span class="n">SPRING</span> <span class="o">=</span> <span class="s2">&quot;spring&quot;</span>

<div class="viewcode-block" id="NetworkLayout.as_layout_func"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.NetworkLayout.html#yawning_titan.networks.network.NetworkLayout.as_layout_func">[docs]</a>    <span class="k">def</span> <span class="nf">as_layout_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maps the NetworkLayout to a function in networkx.drawing.layout.&quot;&quot;&quot;</span>
        <span class="n">layout_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">BIPARTITE</span><span class="p">:</span> <span class="n">bipartite_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">CIRCULAR</span><span class="p">:</span> <span class="n">circular_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">FRUCHTERMAN_REINGOLD</span><span class="p">:</span> <span class="n">fruchterman_reingold_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">KAMADA_KAWAI</span><span class="p">:</span> <span class="n">kamada_kawai_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">MULTIPARTITE</span><span class="p">:</span> <span class="n">multipartite_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">PLANAR</span><span class="p">:</span> <span class="n">planar_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span> <span class="n">random_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">RESCALE</span><span class="p">:</span> <span class="n">rescale_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">SHELL</span><span class="p">:</span> <span class="n">shell_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">SPECTRAL</span><span class="p">:</span> <span class="n">spectral_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">SPIRAL</span><span class="p">:</span> <span class="n">spiral_layout</span><span class="p">,</span>
            <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">SPRING</span><span class="p">:</span> <span class="n">spring_layout</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">layout_dict</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="RandomHighValueNodePreference"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.RandomHighValueNodePreference.html#yawning_titan.networks.network.RandomHighValueNodePreference">[docs]</a><span class="k">class</span> <span class="nc">RandomHighValueNodePreference</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preference of how the random high value nodes are placed.&quot;&quot;&quot;</span>

    <span class="n">FURTHEST_AWAY_FROM_ENTRY</span> <span class="o">=</span> <span class="s2">&quot;FURTHEST_AWAY_FROM_ENTRY&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prefer nodes furthest away from entry nodes.&quot;&quot;&quot;</span>
    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;No preference.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="RandomEntryNodePreference"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.RandomEntryNodePreference.html#yawning_titan.networks.network.RandomEntryNodePreference">[docs]</a><span class="k">class</span> <span class="nc">RandomEntryNodePreference</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preference of hw the random entry nodes are placed.&quot;&quot;&quot;</span>

    <span class="n">CENTRAL</span> <span class="o">=</span> <span class="s2">&quot;CENTRAL&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prefer central nodes.&quot;&quot;&quot;</span>
    <span class="n">EDGE</span> <span class="o">=</span> <span class="s2">&quot;EDGE&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prefer edge nodes.&quot;&quot;&quot;</span>
    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;No preference.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Network"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network">[docs]</a><span class="k">class</span> <span class="nc">Network</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Network that the NetworkInterface interacts with.</span>

<span class="sd">    Network extends networkx.Graph.</span>

<span class="sd">    Example:</span>
<span class="sd">        .. code::python</span>


<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Network.__init__"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.html#yawning_titan.networks.network.Network.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">set_random_entry_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">random_entry_node_preference</span><span class="p">:</span> <span class="n">RandomEntryNodePreference</span> <span class="o">=</span> <span class="n">RandomEntryNodePreference</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
        <span class="n">num_of_random_entry_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">set_random_high_value_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">random_high_value_node_preference</span><span class="p">:</span> <span class="n">RandomHighValueNodePreference</span> <span class="o">=</span> <span class="n">RandomHighValueNodePreference</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
        <span class="n">num_of_random_high_value_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">set_random_vulnerabilities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">node_vulnerability_lower_bound</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="n">node_vulnerability_upper_bound</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">doc_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DocMetadata</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Network constructor.</span>

<span class="sd">        :param set_random_entry_nodes: Whether entry nodes are set at random</span>
<span class="sd">            if not set in nodes. Default value of False.</span>
<span class="sd">        :param random_entry_node_preference: The random entry node placement</span>
<span class="sd">            preference as an instance of</span>
<span class="sd">            yawning_titan.networks.network.RandomEntryNodePreference.</span>
<span class="sd">            Default value of RandomEntryNodePreference.NONE.</span>
<span class="sd">        :param num_of_random_entry_nodes: The number of random entry nodes</span>
<span class="sd">            that will be attempted to be set.</span>
<span class="sd">        :param set_random_high_value_nodes: Whether high value nodes are set</span>
<span class="sd">            at random if not set in nodes. Default value of False.</span>
<span class="sd">        :param random_high_value_node_preference: The random high value node</span>
<span class="sd">            placement preference as an instance of</span>
<span class="sd">            yawning_titan.networks.network.RandomHighValueNodePreference.</span>
<span class="sd">            Default value of RandomHighValueNodePreference.NONE.</span>
<span class="sd">        :param num_of_random_high_value_nodes: The number of random high value</span>
<span class="sd">            nodes that will be attempted to be set.</span>
<span class="sd">        :param set_random_vulnerabilities: Whether node vulnerability scores</span>
<span class="sd">            are set at random.</span>
<span class="sd">        :param node_vulnerability_lower_bound: The lower-bound of a nodes</span>
<span class="sd">            vulnerability score. Default value of 0.01.</span>
<span class="sd">        :param node_vulnerability_upper_bound: The upper-bound of a nodes</span>
<span class="sd">            vulnerability score. Default value of 0.01.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_random_entry_nodes</span> <span class="o">=</span> <span class="n">set_random_entry_nodes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If no entry nodes are added, set them at random. Default is ``False``.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_entry_node_preference</span> <span class="o">=</span> <span class="n">random_entry_node_preference</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of random entry node preference.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_entry_nodes</span> <span class="o">=</span> <span class="n">num_of_random_entry_nodes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of random entry nodes to be generated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_random_high_value_nodes</span> <span class="o">=</span> <span class="n">set_random_high_value_nodes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If no high value nodes are added, set them at random. Default is ``False``.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_high_value_node_preference</span> <span class="o">=</span> <span class="n">random_high_value_node_preference</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of random high value node preference.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span> <span class="o">=</span> <span class="n">num_of_random_high_value_nodes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The number of random high_value nodes to be generated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_random_vulnerabilities</span> <span class="o">=</span> <span class="n">set_random_vulnerabilities</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;If True, random vulnerability is set for each node using the upper and lower bounds.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_vulnerability_lower_bound</span> <span class="o">=</span> <span class="n">node_vulnerability_lower_bound</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A lower vulnerability means that a node is less likely to be compromised. Default value is 0.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_vulnerability_upper_bound</span> <span class="o">=</span> <span class="n">node_vulnerability_upper_bound</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A higher vulnerability means that a node is more vulnerable. Default value is 1.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doc_metadata</span> <span class="o">=</span> <span class="n">doc_metadata</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Access the `nodes` property from the superclass which has `list` properties but is a `NodeView` instance&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_doc_metadata</span> <span class="o">=</span> <span class="n">DocMetadata</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high_value_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of the high value nodes in the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">high_value_node</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entry_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of the entry nodes in the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">entry_node</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deceptive_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of the deceptive nodes in the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">deceptive_node</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">node_vulnerability_lower_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The minimum value that a node within the networks vulnerability can take.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_vulnerability_lower_bound</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_possible_high_value_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum number of allowed high value nodes in the network.</span>

<span class="sd">        Number of possible high value nodes calculated by seeing how many nodes there are minus the entry</span>
<span class="sd">        nodes, then only having 15% of the nodes left over to be high value nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">doc_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DocMetadata</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The configs document metadata.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_metadata</span>

    <span class="nd">@node_vulnerability_lower_bound</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">node_vulnerability_lower_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Node vulnerability lower bound must be above 0.&quot;</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_node_vulnerability_lower_bound</span> <span class="o">=</span> <span class="n">x</span>

    <span class="nd">@doc_metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">doc_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc_metadata</span><span class="p">:</span> <span class="n">DocMetadata</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_doc_metadata</span> <span class="o">=</span> <span class="n">doc_metadata</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Cannot set _doc_metadata as it has already been set.&quot;</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<div class="viewcode-block" id="Network.add_node"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.add_node">[docs]</a>    <span class="k">def</span> <span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_for_adding</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a node to the network.</span>

<span class="sd">        Extend the `add_node` method of the superclass.</span>

<span class="sd">        if the `node_for_adding` is a special node then check that there are no intersections between hvn and entry_node&#39;s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node_for_adding</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node_for_adding</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node_for_adding</span><span class="o">.</span><span class="n">entry_node</span> <span class="ow">or</span> <span class="n">node_for_adding</span><span class="o">.</span><span class="n">high_value_node</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_check_intersect</span><span class="p">(</span><span class="n">node_for_adding</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_node_positions</span><span class="p">()</span></div>

<div class="viewcode-block" id="Network.remove_node"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.remove_node">[docs]</a>    <span class="k">def</span> <span class="nf">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">Node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove a node from the network.</span>

<span class="sd">        Extend the `remove_node` method of the superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_node_positions</span><span class="p">()</span></div>

<div class="viewcode-block" id="Network.add_edge"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.add_edge">[docs]</a>    <span class="k">def</span> <span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u_of_edge</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">v_of_edge</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an edge between 2 nodes in the network.</span>

<span class="sd">        Extend the `add_edge` method of the superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u_of_edge</span><span class="p">,</span> <span class="n">v_of_edge</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_node_positions</span><span class="p">()</span></div>

<div class="viewcode-block" id="Network.remove_edge"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.remove_edge">[docs]</a>    <span class="k">def</span> <span class="nf">remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove an edge between 2 nodes in the network.</span>

<span class="sd">        Extend the `remove_edge` method of the superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="Network.reset"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets the network.</span>

<span class="sd">        This is done by calling:</span>

<span class="sd">        - reset_random_entry_nodes()</span>
<span class="sd">        - reset_random_high_value_nodes</span>
<span class="sd">        - reset_random_vulnerabilities()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_entry_nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_random_entry_nodes</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_high_value_nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_random_high_value_nodes</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_vulnerabilities</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_random_vulnerabilities</span><span class="p">()</span></div>

<div class="viewcode-block" id="Network.show"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show details of all Nodes in the Network.</span>

<span class="sd">        :param verbose: If True, all Node attributes are shown, otherwise</span>
<span class="sd">            just the uuid is shown.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;UUID&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;High Value Node&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Entry Node&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Vulnerability&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Position (x,y)&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;uuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;high_value_node&quot;</span><span class="p">,</span>
            <span class="s2">&quot;entry_node&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vulnerability&quot;</span><span class="p">,</span>
            <span class="s2">&quot;position&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">node_dict</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="n">node_dict</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">x_pos</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">y_pos</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">node_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">}</span>
            <span class="n">row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">([</span><span class="n">headers</span><span class="p">]</span> <span class="o">+</span> <span class="n">rows</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;firstrow&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="Network.get_nodes"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.get_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">get_nodes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_true_compromised</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_blue_view_compromised</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_true_safe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_blue_view_safe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_isolated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_non_isolated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_deceptive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_non_deceptive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">key_by_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">as_list</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all of the nodes from the network and apply a filter(s) to extract a specific subset of the nodes.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_true_compromised: Filter so only nodes that are compromised remain</span>
<span class="sd">            filter_blue_view_compromised: Filter so only nodes that blue can see are compromised remain</span>
<span class="sd">            filter_true_safe: Filter so only nodes that are safe remain</span>
<span class="sd">            filter_blue_view_safe: Filter so only nodes that blue can see are safe remain</span>
<span class="sd">            filter_isolated: Filter so only isolated nodes remain</span>
<span class="sd">            filter_non_isolated: Filter so only connected nodes remain</span>
<span class="sd">            filter_deceptive: Filter so only deceptive nodes remain</span>
<span class="sd">            filter_non_deceptive: Filter so only non-deceptive nodes remain</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
        <span class="k">if</span> <span class="n">filter_true_compromised</span><span class="p">:</span>
            <span class="c1"># Return true if compromised status is 1</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">true_compromised_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_blue_view_compromised</span><span class="p">:</span>
            <span class="c1"># Return True if blue view compromised status is 1</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">blue_view_compromised_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_true_safe</span><span class="p">:</span>
            <span class="c1"># Return True if compromised status is 0</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">true_compromised_status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_blue_view_safe</span><span class="p">:</span>
            <span class="c1"># Return True if blue view compromised status is 0</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">blue_view_compromised_status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_isolated</span><span class="p">:</span>
            <span class="c1"># Return True if isolated is True</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isolated</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_non_isolated</span><span class="p">:</span>
            <span class="c1"># Return True if isolated is False</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">isolated</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_deceptive</span><span class="p">:</span>
            <span class="c1"># Return True if deceptive node is True</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">deceptive_node</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filter_non_deceptive</span><span class="p">:</span>
            <span class="c1"># Return True if deceptive node is False</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">deceptive_node</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">key_by_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">as_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nodes</span></div>

<div class="viewcode-block" id="Network.get_node_from_uuid"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.get_node_from_uuid">[docs]</a>    <span class="k">def</span> <span class="nf">get_node_from_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the first node that has a given uuid.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">uuid</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">node</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Network.get_node_from_name"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.get_node_from_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_node_from_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the first node that has a given name.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">node</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">_generate_random_vulnerability</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a single random vulnerability value from the lower and upper bounds.</span>

<span class="sd">        :returns: A single float representing a vulnerability.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_vulnerability_lower_bound</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_vulnerability_upper_bound</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that high value nodes and entry nodes do not overlap.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_value_nodes</span><span class="p">:</span>
            <span class="n">uuids_intersect</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">n</span><span class="o">.</span><span class="n">uuid</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_value_nodes</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">uuids_intersect</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">uuid</span> <span class="ow">in</span> <span class="n">uuids_intersect</span><span class="p">:</span>
                    <span class="n">node_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="ne">UserWarning</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Entry nodes and high value nodes intersect at node &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">node_str</span><span class="si">}</span><span class="s2">&#39;, and may cause the training to end &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;prematurely.&quot;</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

<div class="viewcode-block" id="Network.set_node_positions"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.set_node_positions">[docs]</a>    <span class="k">def</span> <span class="nf">set_node_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_layout</span><span class="p">:</span> <span class="n">NetworkLayout</span> <span class="o">=</span> <span class="n">NetworkLayout</span><span class="o">.</span><span class="n">SPRING</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the Node positions of the current Network.</span>

<span class="sd">        :param network_layout: A member of NetworkLayout. Default is</span>
<span class="sd">            NetworkLayout.SPRING.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos_dict</span> <span class="o">=</span> <span class="n">network_layout</span><span class="o">.</span><span class="n">as_layout_func</span><span class="p">()(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">node_position</span> <span class="o">=</span> <span class="n">pos_dict</span><span class="p">[</span><span class="n">node</span><span class="p">]</span></div>

<div class="viewcode-block" id="Network.reset_random_entry_nodes"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.reset_random_entry_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">reset_random_entry_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the entry nodes.</span>

<span class="sd">        If no entry nodes supplied then the first node in the network is chosen as the initial node.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">node_dict</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">centrality</span><span class="o">.</span><span class="n">eigenvector_centrality</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">nx</span><span class="o">.</span><span class="n">PowerIterationFailedConvergence</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">node_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="mf">0.5</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">()}</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">node_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">all_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">node_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_entry_node_preference</span> <span class="o">==</span> <span class="n">RandomEntryNodePreference</span><span class="o">.</span><span class="n">EDGE</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_entry_node_preference</span> <span class="o">==</span> <span class="n">RandomEntryNodePreference</span><span class="o">.</span><span class="n">CENTRAL</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_entry_node_preference</span> <span class="o">==</span> <span class="n">RandomEntryNodePreference</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">)</span>

        <span class="n">weights_normal</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>

        <span class="n">entry_nodes</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span>
            <span class="n">all_nodes</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_entry_nodes</span><span class="p">,</span>
            <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">p</span><span class="o">=</span><span class="n">weights_normal</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">entry_nodes</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">entry_node</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">entry_node</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_intersect</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></div>

<div class="viewcode-block" id="Network.reset_random_high_value_nodes"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.reset_random_high_value_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">reset_random_high_value_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets up the high value nodes (HVNs) to be used by the training environment.</span>

<span class="sd">        If HVNs are supplied in the `Network`, they are used. However, if they are not supplied, the following</span>
<span class="sd">        logic is applied:</span>
<span class="sd">            If game_mode.game_rules.lose_when_high_value_node_lost is True:</span>
<span class="sd">                An acceptable amount (math.ceil((len(current_graph.nodes) - len(entry_nodes) + 1) * 0.15) of</span>
<span class="sd">                HVNs are defined from a list of potential HVSn at random after steps are taken to ensure that HVNs are</span>
<span class="sd">                not entry nodes.</span>
<span class="sd">            Otherwise:</span>
<span class="sd">                HVNs are set to an empty list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Cannot set random high value nodes before setting entry nodes.&quot;</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">NetworkError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># print warning that the number of high value nodes exceed the above preferably this would be handled</span>
        <span class="c1"># elsewhere i.e. configuration.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The configured number of high value nodes exceed the allowable number in the given &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;networks. </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span><span class="p">)</span><span class="si">}</span><span class="s2"> high value nodes will be created.&quot;</span>
            <span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
            <span class="n">number_of_high_value_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The configured number of high value nodes, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;must be greater than 0. </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span><span class="p">)</span><span class="si">}</span><span class="s2"> high value nodes will be created.&quot;</span>
            <span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
            <span class="n">number_of_high_value_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">number_of_high_value_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span>

        <span class="n">possible_high_value_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># chooses a random node to be the high value node</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_high_value_node_preference</span> <span class="o">==</span> <span class="n">RandomHighValueNodePreference</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span>
            <span class="n">possible_high_value_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="c1"># Choose the node that is the furthest away from the entry points as the high value node</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">random_high_value_node_preference</span><span class="o">.</span><span class="n">FURTHEST_AWAY_FROM_ENTRY</span>
            <span class="o">==</span> <span class="n">RandomHighValueNodePreference</span><span class="o">.</span><span class="n">FURTHEST_AWAY_FROM_ENTRY</span>
        <span class="p">):</span>
            <span class="c1"># gets all the paths between nodes</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span><span class="p">:</span>
                <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">all_pairs_shortest_path_length</span><span class="p">(</span><span class="bp">self</span><span class="p">))[</span><span class="n">n</span><span class="p">])</span>
            <span class="n">sums</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
            <span class="n">counters</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
            <span class="c1"># gets the distances to the entry points</span>
            <span class="k">for</span> <span class="n">itemset</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
                <span class="n">sums</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itemset</span><span class="p">)</span>
                <span class="n">counters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itemset</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="c1"># averages the distances to find the node that is, on average, the furthest away</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">sums</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">/</span> <span class="n">counters</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sums</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span><span class="p">):</span>
                <span class="n">current</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
                <span class="n">possible_high_value_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>

            <span class="c1"># prevent high value nodes from becoming entry nodes</span>
            <span class="n">possible_high_value_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">possible_high_value_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_nodes</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># randomly pick unique nodes from a list of possible high value nodes</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">possible_high_value_nodes</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>  <span class="c1"># If there are none possible then try again</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_random_high_value_nodes</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_high_value_nodes</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">number_of_high_value_nodes</span><span class="p">:</span>
            <span class="n">number_of_high_value_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_high_value_nodes</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The configured number of high value nodes, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;cannot be created with the chosen method. Instead </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_possible_high_value_nodes</span><span class="p">)</span><span class="si">}</span><span class="s2"> high value nodes will be created.&quot;</span>
            <span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

        <span class="n">high_value_nodes</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">possible_high_value_nodes</span><span class="p">),</span>
            <span class="n">number_of_high_value_nodes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">high_value_nodes</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">high_value_node</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">high_value_node</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_intersect</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></div>

<div class="viewcode-block" id="Network.reset_random_vulnerabilities"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.reset_random_vulnerabilities">[docs]</a>    <span class="k">def</span> <span class="nf">reset_random_vulnerabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Regenerate random vulnerabilities for every node in the network.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_vulnerabilities</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">vulnerability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_vulnerability</span><span class="p">()</span></div>

<div class="viewcode-block" id="Network.to_dict"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_serializable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Represent the `Network` as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">random_entry_node_preference</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_entry_node_preference</span><span class="p">:</span>
            <span class="n">random_entry_node_preference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_entry_node_preference</span><span class="o">.</span><span class="n">value</span>

        <span class="n">random_high_value_node_preference</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_high_value_node_preference</span><span class="p">:</span>
            <span class="n">random_high_value_node_preference</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">random_high_value_node_preference</span><span class="o">.</span><span class="n">value</span>
            <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;set_random_entry_nodes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_entry_nodes</span><span class="p">,</span>
            <span class="s2">&quot;random_entry_node_preference&quot;</span><span class="p">:</span> <span class="n">random_entry_node_preference</span><span class="p">,</span>
            <span class="s2">&quot;num_of_random_entry_nodes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_entry_nodes</span><span class="p">,</span>
            <span class="s2">&quot;set_random_high_value_nodes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_high_value_nodes</span><span class="p">,</span>
            <span class="s2">&quot;random_high_value_node_preference&quot;</span><span class="p">:</span> <span class="n">random_high_value_node_preference</span><span class="p">,</span>
            <span class="s2">&quot;num_of_random_high_value_nodes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_random_high_value_nodes</span><span class="p">,</span>
            <span class="s2">&quot;set_random_vulnerabilities&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_random_vulnerabilities</span><span class="p">,</span>
            <span class="s2">&quot;node_vulnerability_lower_bound&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_vulnerability_lower_bound</span><span class="p">,</span>
            <span class="s2">&quot;node_vulnerability_upper_bound&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_vulnerability_upper_bound</span><span class="p">,</span>
            <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_node&quot;</span><span class="p">],</span>
            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_adj&quot;</span><span class="p">],</span>
            <span class="s2">&quot;_doc_metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">json_serializable</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span> <span class="n">k</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span> <span class="p">{</span><span class="n">node</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span> <span class="n">attrs</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">attrs</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;_doc_metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;_doc_metadata&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="Network.to_adj_matrix_and_positions"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.to_adj_matrix_and_positions">[docs]</a>    <span class="k">def</span> <span class="nf">to_adj_matrix_and_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Represent the network by its adjacency matrix and a dictionary of node names to positions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">node_position</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span></div>

<div class="viewcode-block" id="Network.create"><a class="viewcode-back" href="../../../source/_autosummary/yawning_titan.networks.network.Network.html#yawning_titan.networks.network.Network.create">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">network_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Network</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instance on :class: `Network` from a dictionary.</span>

<span class="sd">        :param network_dict: a dictionary describing a :class:`Network`</span>
<span class="sd">        :return: An instance of :class: `Network`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">network_dict</span><span class="p">[</span><span class="s2">&quot;doc_metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DocMetadata</span><span class="p">(</span><span class="o">**</span><span class="n">network_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;_doc_metadata&quot;</span><span class="p">))</span>
        <span class="n">network_dict</span><span class="p">[</span><span class="s2">&quot;random_entry_node_preference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RandomEntryNodePreference</span><span class="p">[</span>
            <span class="n">network_dict</span><span class="p">[</span><span class="s2">&quot;random_entry_node_preference&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">network_dict</span><span class="p">[</span>
            <span class="s2">&quot;random_high_value_node_preference&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">RandomHighValueNodePreference</span><span class="p">[</span>
            <span class="n">network_dict</span><span class="p">[</span><span class="s2">&quot;random_high_value_node_preference&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">network</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="o">**</span><span class="n">network_dict</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">attrs</span> <span class="ow">in</span> <span class="n">network_dict</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">network</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">Node</span><span class="o">.</span><span class="n">create_from_db</span><span class="p">(</span><span class="o">**</span><span class="n">attrs</span><span class="p">))</span>

        <span class="n">network</span><span class="o">.</span><span class="n">set_node_positions</span><span class="p">()</span>

        <span class="n">edge_tuples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">uuid_u</span><span class="p">,</span> <span class="n">edges</span> <span class="ow">in</span> <span class="n">network_dict</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">uuid_v</span> <span class="ow">in</span> <span class="n">edges</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">edge_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">uuid_u</span><span class="p">,</span> <span class="n">uuid_v</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">edge_tuple</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edge_tuples</span><span class="p">:</span>
                    <span class="n">edge_tuples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge_tuple</span><span class="p">)</span>
                    <span class="n">node_u</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">get_node_from_uuid</span><span class="p">(</span><span class="n">edge_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">node_v</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">get_node_from_uuid</span><span class="p">(</span><span class="n">edge_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">network</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node_u</span><span class="p">,</span> <span class="n">node_v</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">set_random_entry_nodes</span><span class="p">:</span>
            <span class="n">network</span><span class="o">.</span><span class="n">reset_random_entry_nodes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">set_random_high_value_nodes</span><span class="p">:</span>
            <span class="n">network</span><span class="o">.</span><span class="n">reset_random_high_value_nodes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">set_random_vulnerabilities</span><span class="p">:</span>
            <span class="n">network</span><span class="o">.</span><span class="n">reset_random_vulnerabilities</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">network</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">uuid</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">uuid</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">net_str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;uuid=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;nodes=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">net_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;name=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">author</span><span class="p">:</span>
            <span class="n">net_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;author=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">author</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
        <span class="n">net_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;locked=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">doc_metadata</span><span class="o">.</span><span class="n">locked</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="k">return</span> <span class="n">net_str</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Crown Copyright (C) Dstl 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>